# Anicca 开发任务清单

## 项目概述
Anicca (无相) 是一个基于佛教哲学的AI对话艺术体验项目，旨在将传统问答转化为冥想式的"存在-消散-觉察"节奏。

## 核心技术架构
- **前端框架**: Next.js 15 (App Router)
- **可视化**: p5.js (WebGL) + Shader3弥散圆
- **状态管理**: Zustand
- **UI组件**: TailwindCSS + shadcn/ui
- **数据存储**: JSON文件 (本地优先)

---

## 阶段一：核心MVP开发

### 1.1 技术基础设施
- [ ] 初始化Next.js 15项目结构
- [ ] 配置TypeScript和ESLint
- [ ] 集成TailwindCSS + shadcn/ui
- [ ] 设置Zustand状态管理
- [ ] 创建基础组件库

### 1.2 弥散圆可视化核心
- [ ] 集成p5.js和Shader3着色器
- [ ] 实现基础弥散圆渲染
- [ ] 添加鼠标交互（点击→形态变化）
- [ ] 优化性能（WebGL渲染）
- [ ] 实现三泡泡回应系统视觉效果
 - [ ] 建立 shaders/mochi.ts 管线与 p5 Canvas 封装（含错误日志）
 - [ ] 点击/键盘/音频事件统一映射到 uPulse（含节流与去抖）
 - [ ] 截图导出 toDataURL 与缩略图生成（节点 thumb）

### 1.3 对话系统架构
- [ ] 设计对话数据结构（DAG节点）
- [ ] 实现状态快照机制
- [ ] 创建JSON导出/导入功能
- [ ] 建立实验分支系统
 - [ ] 使用 zod 定义 project.json Schema（导入校验与错误提示）
 - [ ] 实现 commit/fork/merge 及 exportJSON/importJSON 的核心操作

### 1.4 基础UI界面
- [ ] 设计禅意美学界面
- [ ] 实现对话输入区域
- [ ] 创建弥散圆展示区域
- [ ] 添加实验历史侧边栏
 - [ ] 右栏参数面板联动 mochi 控制项（noise/mix/color/grain 等）

---

## 阶段二：交互体验完善

### 2.1 三泡泡回应系统
- [ ] 实现泡泡扩展动画
- [ ] 添加泡泡提问功能
- [ ] 设计泡泡静默效果
- [ ] 优化泡泡间过渡动画

### 2.2 音频响应集成（参考mochi.ts）
- [ ] 集成Web Audio API
- [ ] 实现基础音频分析（响度、频谱）
- [ ] 添加音频驱动的视觉效果
- [ ] 优化音频响应性能
 - [ ] 将 level/flux/centroid/zcr/mfcc ↔ uniforms 映射与校准

### 2.3 实验管理功能
- [ ] 实现实验创建/保存/加载
- [ ] 添加实验分支功能
- [ ] 设计实验对比界面
- [ ] 优化大量实验的性能

---

## 阶段三：高级功能与优化

### 3.1 视觉效果增强
- [ ] 从mochi.ts提取体积渲染技术
- [ ] 添加噪声和纹理细节
- [ ] 实现颜色循环系统
- [ ] 优化光照和阴影效果

### 3.2 用户体验优化
- [ ] 实现响应式设计
- [ ] 添加键盘快捷键
- [ ] 优化加载性能
- [ ] 实现离线功能支持

### 3.3 数据管理完善
- [ ] 实现增量保存机制
- [ ] 添加数据压缩功能
- [ ] 设计备份/恢复系统
- [ ] 优化大型实验集的内存使用

---

## 阶段四：扩展与部署

### 4.1 云端同步（可选）
- [ ] 设计云端迁移架构
- [ ] 集成Supabase认证
- [ ] 实现数据同步功能
- [ ] 添加多设备支持

### 4.2 社区功能
- [ ] 设计实验分享机制
- [ ] 实现模板系统
- [ ] 添加用户反馈收集
- [ ] 创建使用教程

### 4.3 部署与发布
- [ ] 配置生产环境构建
- [ ] 实现CI/CD流程
- [ ] 设计监控和日志系统
- [ ] 准备发布文档

---

## 技术决策记录

### 弥散圆技术选型
- **选择**: Shader3 (ShaderPark)
- **理由**: 简洁优雅，符合禅意美学，交互直观
- **参考**: mochi.ts的音频响应和体积渲染技术

### 状态管理策略
- **方案**: Zustand + JSON快照
- **优势**: 轻量级，支持时间旅行，易于序列化
- **结构**: DAG节点 + 完整状态快照

### 数据持久化
- **策略**: 本地优先，渐进式云迁移
- **格式**: JSON文件导出/导入
- **特点**: 无数据库架构，支持实验分支

---

## 开发优先级

### 高优先级 (P0)
- [ ] 基础项目搭建
- [ ] 弥散圆核心功能
- [ ] 对话系统架构

### 中优先级 (P1)
- [ ] 三泡泡交互系统
- [ ] 实验管理功能
- [ ] UI/UX完善

### 低优先级 (P2)
- [ ] 音频响应集成
- [ ] 云端同步功能
- [ ] 社区功能

---

## 设计原则

1. **简洁优先**: 保持代码和功能的简洁性
2. **本地优先**: 核心功能不依赖网络连接
3. **渐进增强**: 从MVP开始，逐步添加功能
4. **哲学一致**: 所有功能符合"无常、无相、无我"的核心理念
5. **性能导向**: 优化用户体验，避免卡顿和延迟

---

## 成功指标

### 技术指标
- [ ] 首次加载时间 < 3秒
- [ ] 弥散圆动画帧率 > 30fps
- [ ] 内存使用 < 100MB
- [ ] 离线功能完整可用

### 用户体验指标
- [ ] 用户能够理解"存在-消散-觉察"的交互节奏
- [ ] 三泡泡回应系统直观易用
- [ ] 实验创建和管理流畅
- [ ] 视觉效果符合禅意美学

---

*最后更新: 2025-10-06*
*项目状态: 规划阶段*